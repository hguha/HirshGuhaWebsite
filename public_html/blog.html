<head><link rel="stylesheet" href="css/blog.css"></head>
<body>
  <div id="sidebar">
    <img src="images/hg-white.svg" class="logo">
    <div class="welcome">HIRSH'S BLOG</div>
    <div class="menu">
      <a style="padding-top:20px" href="/">Back To Home</a>
      <a href="/#projects">Projects</a>
      <a href="/#about">About</a>
    </div>
  </div>
  <div id="content"></div>
  
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  <script>
    let numBlogs = 0;

    async function getNumBlogs() {
      var counter = 1;
      while(true) {
            try {
                await $.get( "posts/post"+counter+".html", function() {counter++;});
            } catch { return counter; }
        }
    }

    function generateListing() {
      $("#content").empty();

      for(let i = numBlogs; i > 0; i-- ) {
        $.get("posts/post"+Number(i)+".html", function( data ) {
          let title = $(data).filter("#title").html();
          let date = $(data).filter("#date").html();
          let preview = $(data).filter("#body").html().slice(0,220);
          $("#content").append(`
          <div class="post">
            <div class="title"><a onclick="loadBlog(${i})">${title}</a></div>
            <div class="date">${date}</div>
            <div class="preview">${preview}...</div>
            <hr style="margin-top:5%; height:1px; background-color:lightgray; border:none">
        </div>`);

      });
      }
    }

    function loadBlog(num) {
      $("#content").load(`posts/post${num}.html`, function() {
      $("#content").prepend(`<button class="back" onclick="generateListing()">&#8592; Back to Listing</button>`);
      });
    }

    window.onload = function() {
      getNumBlogs().then(function( data ) {
        numBlogs = data - 1;
        generateListing();
      });
    }

  </script> 
  
</body>

